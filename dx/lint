#!/bin/bash
# Run ESLint for JavaScript/TypeScript code quality checks

# Source common functions
source "$(dirname "$0")/_common"
check_docker

# Check if --fix or -f flag is present and convert to proper ESLint command
if [[ "$*" == *"--fix"* ]] || [[ "$*" == *" -f"* ]] || [[ "$*" == "-f"* ]]; then
    echo "üîß Running ESLint with auto-fix..."
    echo "üí° This will automatically fix fixable style issues"
    echo "‚ö†Ô∏è  Auto-fix will modify your code files"
    echo ""
    
    docker run -it --rm \
        -v "$(pwd):/app" \
        -v /app/node_modules \
        yoo-nuxt-todo:dev \
        pnpm lint:fix
    
    echo ""
    echo "‚úÖ Auto-fix complete! Review changes before committing."
else
    echo "üîç Running ESLint linter..."
    echo "üí° This will check JavaScript/TypeScript code style and quality"
    echo "üîß Use './dx/lint --fix' or './dx/lint -f' to automatically fix issues"
    echo ""
    
    docker run -it --rm \
        -v "$(pwd):/app" \
        -v /app/node_modules \
        yoo-nuxt-todo:dev \
        pnpm lint
    
    echo ""
    echo "‚úÖ Linting complete!"
fi