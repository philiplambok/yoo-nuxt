#!/bin/bash
# Start Docker development container in detached mode

# Parse arguments for help
for arg in "$@"; do
    case $arg in
        --help|-h)
            echo "Usage: ./dx/start"
            echo ""
            echo "Start Docker development container in background mode using docker-compose"
            echo ""
            echo "Features:"
            echo "  ‚Ä¢ Starts container in detached mode"
            echo "  ‚Ä¢ Volume mounting for live reload"
            echo "  ‚Ä¢ Accessible at http://localhost:3000"
            echo "  ‚Ä¢ Enables other dx commands (test, lint, dev) to work"
            echo ""
            echo "Options:"
            echo "  --help, -h          Show this help message"
            echo ""
            echo "Examples:"
            echo "  ./dx/start                  # Start development container"
            echo ""
            echo "After starting:"
            echo "  ./dx/dev                    # Start development server"
            echo "  ./dx/shell                  # Access container shell"
            echo "  ./dx/test                   # Run tests"
            echo "  ./dx/lint                   # Run linter"
            exit 0
            ;;
    esac
done

# Source common functions
source "$(dirname "$0")/_common"
check_docker
check_image_exists

echo "üöÄ Starting development container in background..."
echo "üí° Use './dx/dev' to start the development server after this completes"
echo ""

# Start containers using docker-compose
if docker-compose -f docker-compose.dev.yml up -d; then
    echo ""
    echo "‚úÖ Container started successfully!"
    echo "üì¶ Container is running in background"
    echo ""
    echo "üöÄ Next steps:"
    echo "   ./dx/dev     - Start development server"
    echo "   ./dx/shell   - Access container shell"
    echo "   ./dx/test    - Run tests"
    echo "   ./dx/lint    - Run linter"
    echo ""
    echo "üõë To stop: ./dx/stop"
else
    echo ""
    echo "‚ùå Failed to start container"
    echo ""
    echo "üí° Possible solutions:"
    echo "   ‚Ä¢ Check if image exists: docker images yoo-nuxt-todo:dev"
    echo "   ‚Ä¢ Rebuild image: ./dx/build"
    echo "   ‚Ä¢ Check Docker logs: docker-compose -f docker-compose.dev.yml logs"
    echo ""
    echo "üìö For more info: ./dx/help"
    exit 1
fi